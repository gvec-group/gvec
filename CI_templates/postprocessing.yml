# ==========================================================================================================================
# Stage "postprocessing"
# ==========================================================================================================================

# ____________________________
# MPCDF new Docker images
# (each providing a toolchain based on a single combination of compiler and MPI variant)

# run with MPCDF Docker (intel2023) shared runner environment
mpcdfci_intel2023_post:
  stage: postprocessing
  before_script:
    - !reference [".tmpl_before_script_modules", "before_script"]
    - !reference [".tmpl_before_script_exportvars", "before_script"]
  extends:
    - .tmpl_mpcdfci_intel2023
    - .tmpl_script_post
    - .vars_matrix_run  # matrix of variables
  needs:
    - job: mpcdfci_intel2023_build
      artifacts: true
    - job: mpcdfci_intel2023_run
      artifacts: true
  rules:
    - if: $MINIMAL_PIPELINE == "false"

# run with MPCDF Docker (gcc13) shared runner environment
mpcdfci_gcc13_post:
  stage: postprocessing
  before_script:
    - !reference [".tmpl_before_script_modules", "before_script"]
    - !reference [".tmpl_before_script_exportvars", "before_script"]
  extends:
    - .tmpl_mpcdfci_gcc13
    - .tmpl_script_post
    - .vars_matrix_post  # matrix of variables
  needs:
    - job: mpcdfci_gcc13_build
      artifacts: true
    - job: mpcdfci_gcc13_run
      artifacts: true
  rules:
    - if: $MINIMAL_PIPELINE == "false"