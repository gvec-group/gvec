!================================================================================================================================= !
! compute initial solution from existing equilibrium
!================================================================================================================================= !

  ProjectName = GVEC_axisNB_N2-12-hi_iota07


  whichInitEquilibrium = 0 ! 0: only from input parameters, 1: from VMEC netcdf file, 2: from internally generated Soloview

!    init_fromBConly = F ! ONLY used if whichInitEquilibrium=1 (VMEC input)
                        ! =T: only use axis and boundary for X1,X2 (True is default) 
                        ! =F: if VMEC input is used, interpolate VMEC data  on the full mesh s=0...1

  init_LA         = F ! T: compute lambda from initial mapping (default),  
                      ! F: lambda=0 or if whichInitEquilibrium=1 use VMEC at initialization 


!================================================================================================================================= !
! visualization parameters
!================================================================================================================================= !
which_visu = 0          ! 0: visualize gvec data, 1: visualize vmec data (whichInitEquilibrium=1)
!visu1D       = 12     ! 0: off, >0:  write 1D data of all modes of R,Z,lambda over the flux / radial coordinate
  np_1d      = 5 
!visu2D       = 12       ! 0: off, 1: write paraview file of boundary, 2: write paraview file for zeta=const. planes 
  np_visu_BC     =   (/41,200/)
  visu_BC_min     = (/ 0.001,0.001/)  ! range of visualization for s,theta,zeta: min in [0,1]
  visu_BC_max     = (/ 1.,1./)  !                                          max in [0,1]

  np_visu_planes = (/8,12,7/)
  visu_planes_min     = (/0. ,0. , 0. /)  ! range of visualization for s,theta,zeta: min in [0,1]
  visu_planes_max     = (/1. ,1. , 0.5 /)  !                                          max in [0,1]
!visu3D       = 1        ! 0: off, 1: write 3D paraview file 
  np_visu_3D     = (/8,12,101/)
!  np_visu_3D     = (/8,12,201/)

!visu_min/max applies to visu_BC,visu_planes and visu_3D if not specified
visu_3D_min     = (/0. ,0.001, 0. /)  ! range of visualization for s,theta,zeta: min in [0,1]
visu_3D_max     = (/1. ,1., 0.5 /)  !                                          max in [0,1]
!visu_3D_max     = (/1. ,1., 1. /)  !                                          max in [0,1]

!visuQ = 2 ! =0: default, only visualize xyz(hmap(q)), =1: only visualize xyz=q, =2: visualize both
outFileType= 12 
!SFLout=2 ! =0: off, =1: write an output in straight-field line coordinates at given SFLout_radialpos positions [0;1].
  SFLout_radialpos=(/0.01,0.1,0.5,1.0/) ! radial output positions ~sqrt(psi) 
  SFLout_mn_max = (/ 5, 5/)
  SFLout_mn_pts = (/80,80/) 
!================================================================================================================================= !
! grid in s direction
!================================================================================================================================= !
sgrid_nElems=2
sgrid_grid_type=0  ! 0: uniform, 1: sqrt (finer at edge), 2: s^2 (finer at center), 3: bump (fine at edge and center)

!================================================================================================================================= !
! discretization parameters
!================================================================================================================================= !

!fac_nyq=-1
!mn_nyq=(/8,40/)

degGP  = 7               ! number of gauss points per radial element

X1X2_deg  = 5            !polynomial degree in radial discretization for X1 and X2 variable

X1_mn_max = (/ 2, 5/)   !maximum mumber of fourier modes (mmax,nmax)
X1_sin_cos = _cos_       !which fourier modes: can be either _sin_,_cos_, or _sincos_

X2_mn_max = (/ 2, 5/)   !maximum mumber of fourier modes (mmax,nmax)
X2_sin_cos = _sin_       !

LA_deg    = 5            ! polynomial degree in radial discretization for Lambda variable
LA_mn_max = (/ 2, 5/)    ! maximum mumber of fourier modes (mmax,nmax)
LA_sin_cos = _sin_       !

which_hmap = 21          !  hmap with a given axis and normal and binormal components (axisNB), generalizes the hmap_frenet. 
nfp = 2
hmap_ncfile = N2.12-v3.1-hi.nc
hmap_nvisu=100

getBoundaryFromFile= 1      ! -1: off, 1: from specific netcdf file 
boundary_filename = N2.12-v3.1-hi.nc
scale_minor_radius=1.0e-0   ! scaling of X,Y boundary points
!================================================================================================================================= !
! fourier modes at the edge boundary condition
! FORMAT AA_X_ccc( M; N) with AA: X1,X2 , X=a/b (axis/edge) 
!                             ccc: cos/sin, ( M; N) without NFP with any number of whitespaces: (  0;  0) ( 1; 0) ( -1; -2) 
! modes which are not specified here are set to zero!!!
!================================================================================================================================= !
!axis only used for initialization:
X1_a_cos(  0;  0) = 0.

!================================================================================================================================= !
! profiles
!================================================================================================================================= !
!iota_coefs= (/-0.700768 /) !(a,b,c,d,...) : iota(phi_norm)=a+b*phi_norm+c*phi_norm^2 ...             phi_norm: normalized tor.flux
iota_coefs= (/-0.70 /) !(a,b,c,d,...) : iota(phi_norm)=a+b*phi_norm+c*phi_norm^2 ...             phi_norm: normalized tor.flux
pres_coefs= (/ 0.0 /)
pres_scale=1500. !

PHIEDGE    = 0.03141592654

!PHIEDGE    =-0.10618610534e+2   !1 ->              ! torodial flux at the last flux surface
!PHIEDGE    = -0.0265465263e+2   !* 0.5^2
!PHIEDGE    = -0.0042474442134e+2 ! *0.2^2
!PHIEDGE    =-0.10618610534e-0   ! *0.1^2 
!PHIEDGE    =-0.10618610534e-2   ! *0.01^2 


!================================================================================================================================= !
! iteration
!================================================================================================================================= !
MaxIter =40            ! maximum number of iterations
start_dt=4.0e-1           ! first timestep, is automatically adapted
minimize_tol=1.0e-10   ! absolute tolerance |Force|*dt<abstol
outputIter =20          ! number of iterations after which a state & visu is written
logIter = 10             ! write log of iterations to screen 

PrecondType =1 ! -1: off(default), 1: on
MinimizerType = 0 ! 0: descent(default), 10: accel. GD
